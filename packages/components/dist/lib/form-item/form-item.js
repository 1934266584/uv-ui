"use strict";const r=require("vue"),m=require("../packages/utils/index.js"),R=require("../cell/index.js");require("./form-item.vue_vue_type_style_index_0_lang.js");const g=require("../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/clone.js"),h={name:"UvFormItem"},k=Object.assign(h,{props:{label:{type:String},labelPosition:{type:String},arrow:{type:Boolean,default:!1},arrowDirection:{type:String},clickable:{type:Boolean,default:!1},prop:{type:String},required:{type:Boolean}},setup(u){const e=u;let d;const v=r.computed(()=>{const t=i==null?void 0:i.model;if(!(!t||!e.prop))return m.getProp(t,e.prop).value}),{props:i,addField:b,removeField:q}=r.inject("form"),{labelWidth:w,rules:n}=i,c=r.ref(null),M=()=>!!(!e.prop||!n[e.prop]||n[e.prop].map(s=>{let a="";return s.required===!0&&(i.model[e.prop]?(o.errorMsg=null,a=!0):(o.errorMsg=s.message,a=!1)),s.trigger&&(a=p(s.trigger)),a}).every(s=>s===!0)),p=t=>{if(!e.prop||!n[e.prop]){e.prop?n[e.prop]||console.error("\u672A\u4F20\u5165\u8BE5\u5C5E\u6027\u7684rule\u89C4\u5219"):console.error("\u8BF7\u4F20\u5165form-item\u4E2D\u4F20\u5165prop\u5C5E\u6027");return}const l=n[e.prop].find(s=>s.trigger===t);if(l){if(l.required)return i.model[e.prop]?(o.errorMsg=null,!0):(o.errorMsg=l.message,!1);if(l.validator){const s=i.model[e.prop];return l.validator(s)?(o.errorMsg=null,!0):(o.errorMsg=l.message,!1)}}else return o.errorMsg=null,!0},y=async()=>{const t=i==null?void 0:i.model;if(!t||!e.prop)return;const l=m.getProp(t,e.prop);l.value=g(d),await r.nextTick(),f()},f=()=>{o.errorMsg=null},o=r.reactive({...r.toRefs(e),$el:c,isRequired:!1,errorMsg:null,clearValidate:f,validate:M,resetField:y});return r.onMounted(()=>{n&&n[e.prop]&&n[e.prop].find(l=>l.required===!0)&&(o.isRequired=!0),d=g(v.value),b(o)}),r.onBeforeMount(()=>{q(o)}),r.provide("form-item",{props:e,validateBlurOrChange:p}),(t,l)=>(r.openBlock(),r.createBlock(r.unref(R),r.mergeProps({class:"uv-form-item",ref_key:"formItemRef",ref:c},t.$attrs,{arrow:u.arrow,"arrow-direction":u.arrowDirection,title:u.label,"label-width":r.unref(w),"label-position":u.labelPosition||r.unref(i).labelPosition,clickable:u.clickable,required:u.required||o.isRequired,tips:!!o.errorMsg,"error-msg":o.errorMsg}),{title:r.withCtx(()=>[r.renderSlot(t.$slots,"label")]),value:r.withCtx(()=>[r.renderSlot(t.$slots,"default")]),_:3},16,["arrow","arrow-direction","title","label-width","label-position","clickable","required","tips","error-msg"]))}});module.exports=k;
